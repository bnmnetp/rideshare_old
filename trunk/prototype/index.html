<!--
  copyright (c) 2009 Google inc.

  You are free to copy and use this sample.
  License can be found here: http://code.google.com/apis/ajaxsearch/faq/#license
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:vml">
  <head>
    <meta http-equiv="content-type" content="text/html;    charset=utf-8"/>
    <link rel="stylesheet" href="static/style.css" type="text/css" media="screen" />
    <title>Luther College Rideshare</title>
    <script src="static/functions.js" type="text/javascript"></script>
    <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=false&amp;key={{mapkey}}" type="text/javascript"></script>
    <script type="text/javascript">
    var map;
    var geocoder;
    var address2;

    var rides = new Array();
// Add all rides to this array
  {% for r in ride_list %}
    var temp = new Ride({{ r.max_passengers }},
                        '{{ r.driver }}',
                        '{{ r.start_point_title }}',
                        {{ r.start_point_lat }},
                        {{ r.start_point_long }},
                        '{{ r.destination_title }}',
                        {{ r.destination_lat }},
                        {{ r.destination_long }},
                        new Date({{ r.ToD.year }}, 
                                 {{ r.ToD.month }} - 1, 
                                 {{ r.ToD.day }}), 
                        '{{ r.part_of_day }}', [{% for p in r.passengers %}{% if not forloop.first %}, {% endif %}'{{ p }}'{% endfor %}],
                        '{{ r.contact }}',
                        '{{ r.key }}');
    rides.push(temp);
  {% endfor %}

      // Begin creation of Icons for Rides
      var greenIcon = new GIcon();
      greenIcon.image = "http://www.google.com/mapfiles/dd-start.png";
//      greenIcon.image = "http://www.google.com/intl/en_us/mapfiles/ms/micons/green-dot.png";
      greenIcon.shadow = "http://labs.google.com/ridefinder/images/mm_20_shadow.png";
      greenIcon.iconSize = new GSize(12, 20); // 12, 20
      greenIcon.shadowSize = new GSize(22, 20);
      greenIcon.iconAnchor = new GPoint(6, 20); // 6, 20
      greenIcon.infoWindowAnchor = new GPoint(10, 1);

      gmarkerOptions = { icon:greenIcon };

      var redIcon = new GIcon();
      redIcon.image = "http://www.google.com/mapfiles/dd-end.png";
      redIcon.shadow = "http://labs.google.com/ridefinder/images/mm_20_shadow.png";
      redIcon.iconSize = new GSize(12, 20);
      redIcon.shadowSize = new GSize(22, 20);
      redIcon.iconAnchor = new GPoint(6, 20);
      redIcon.infoWindowAnchor = new GPoint(5, 1);

      rmarkerOptions = { icon:redIcon };

      // Sample custom marker code created with Google Map Custom Marker Maker
      // http://www.powerhut.co.uk/googlemaps/custom_markers.php

      var myIcon = new GIcon();
      myIcon.image = 'static/image.png';
      myIcon.shadow = 'static/shadow.png';
      myIcon.iconSize = new GSize(20,17);
      myIcon.shadowSize = new GSize(29,17);
      myIcon.iconAnchor = new GPoint(10,17);
      myIcon.infoWindowAnchor = new GPoint(10,0);
      myIcon.printImage = 'static/printImage.gif';
      myIcon.mozPrintImage = 'static/mozPrintImage.gif';
      myIcon.printShadow = 'static/printShadow.gif';
      myIcon.transparent = 'static/transparent.png';
      myIcon.imageMap = [19,0,19,1,19,2,18,3,18,4,17,5,16,6,19,7,19,8,19,9,19,10,16,11,19,12,13,13,13,14,15,15,19,16,8,16,7,15,6,14,6,13,5,12,5,11,5,10,4,9,4,8,4,7,3,6,2,5,1,4,1,3,0,2,0,1,0,0];

      bmarkerOptions = { icon:myIcon };
      // End creation of Icon for Rides

      var blueIcon = new GIcon(G_DEFAULT_ICON);
      blueIcon.image = "http://labs.google.com/ridefinder/images/mm_20_blue.png";
      blueIcon.iconSize = new GSize(20, 20);
      markerOptions = { icon:myIcon };
      var marker = new GMarker(new GLatLng(43.313059,-91.799501), markerOptions);

      var alpha = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';
    </script>
  </head>

  <body onload="initialize()" onunload="GUnload()" style="font-family: Arial;border: 0 none;">
    <div id="titleblock">
    <h1>Luther College Rideshare</h1>
<div id="navbar">
<ul>
<li>
Welcome, {{nick}}
</li>
<li>
<a href="{{logout}}">sign out</a>
</li>
<li>
<a href="/home">Your Rides</a>
</li>
<li>
<a href="/static/help.html">Help</a>
</li>
</ul>
</div>
    </div>
   <div id="instructions" class="clearfix">
    {% if message %}
    <p>{{ message }}</p>
    {% endif %}
<table>
<tr>
<td width=50%>
       Click anywhere on the map to create a
       destination or starting point.  You can
       add yourself to a ride by clicking on one of the red or
       green pushpins on the map.  <br><br>
       Enter an address or filter the pushpins by date using the
       controls on the right.
</td>
<td id="filterside">

   <form action="#" onsubmit="showAddress(this.address.value); return false">
       Enter an address:
         <input type="text" size="60" name="address" value="700 College Dr., Decorah, IA" />
         <input type="submit" value="Go!" />
    </form>

<!--  Date Filtering Form  -->

<table id="begend">
<form name="dateForm">
<tr>
<td>
      Beginning: 
</td>
<td>
      <select name="imonth" id="imonth" onChange="changeDays(document.forms.dateForm.iday, this); return false;">
        <script type="text/javascript">{monthOptions();}</script>
      </select>
      <select name="iday" id="iday"> <!-- Populated in later script -->
      </select>
      <select name="iyear" id="iyear">
        <script type="text/javascript">
          {yearOptions();}
        </script>
      </select>
</td>
</tr>

<tr>
<td>
      Ending:
</td>
<td>
      <select name="fmonth" id="fmonth" onChange="changeDays(document.forms.dateForm.fday, this); return false;">
        <script type="text/javascript">{monthOptions();}</script>
      </select>
      <select name="fday" id="fday"> <!-- Populated in later script -->
      </select>
      <select name="fyear" id="fyear">
        <script type="text/javascript">
          {
            yearOptions();
            
            // Populate the two day pulldown menus
            var select1 = document.forms.dateForm.iday;
            var select2 = document.forms.dateForm.fday;
            for (var i = 0; i < 31; i++)
            {
              addOption(select1, i, i+1);
              addOption(select2, i, i+1);
            }
          }
        </script>
      </select>
</td>
</tr>
<tr>
<td>
      <input type="button" value="Show Matching Rides" 
               onclick="changeDates(document.getElementById('imonth').options.valueOf().selectedIndex,
		document.getElementById('iday').options.valueOf().selectedIndex,
		document.getElementById('iyear').options.valueOf().selectedIndex,
		document.getElementById('fmonth').options.valueOf().selectedIndex,
		document.getElementById('fday').options.valueOf().selectedIndex,
		document.getElementById('fyear').options.valueOf().selectedIndex);"
/>
</td></tr>
</table>
    </form>


</td>
</table>
       </div>
<div style="clear: both;"></div>

<div id="map_canvas" ></div>

<div id="filters">
<br /> 
<br />
</div>
<p>Below is a table listing all available rides.</p>
<script type="text/javascript">changefDays(); changeiDays();</script>
    <table border="-1" id="rideTable">
      <tr>
        <th>Driver's Name</th>
        <th>Max Passengers</th>
        <th>Number of Passengers</th>
        <th>Starting Point</th>
        <th>Destination</th>
        <th>Time of Departure</th>
      </tr>
    </table>
<script type="text/javascript">

    var table = document.getElementById("rideTable");
    var r;
    for (r in rides)
    {
      var row = table.insertRow(table.rows.length);
      var c0 = row.insertCell(0);
      c0.innerHTML = rides[r].driver;
      var c1 = row.insertCell(1);
      c1.innerHTML = rides[r].max_passengers;
      var c2 = row.insertCell(2);
      c2.innerHTML = rides[r].num_passengers;
      var c3 = row.insertCell(3);
      c3.innerHTML = rides[r].start_point.title;
      var c4 = row.insertCell(4);
      c4.innerHTML = rides[r].destination.title;
      var c5 = row.insertCell(5);
      c5.innerHTML = rides[r].part_of_day + " " + numToTextMonth(rides[r].ToD.getMonth())+" "+rides[r].ToD.getDate()+", "+rides[r].ToD.getFullYear();
    }

</script>
  </body>
</html>â€‹
